{"ast":null,"code":"import _possibleConstructorReturn from \"/Users/malba/Code/Botix/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/malba/Code/Botix/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/malba/Code/Botix/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _classCallCheck from \"/Users/malba/Code/Botix/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/malba/Code/Botix/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport React, { Component } from 'react';\nimport io from \"socket.io-client\";\nvar HOST;\nif (window.window.location.hostname == \"localhost\") HOST = \"http://localhost:3040\";else HOST = \"https://api.Botix.com\";\nHOST = \"http://192.168.7.103:3040\";\nvar user = JSON.parse(window.localStorage.getItem(\"user\"));\nvar jwt = window.localStorage.getItem(\"jwt\"); // const Socket = io(\"https://api.labmovil.cl/?token=\" + window.token.vilab);\n//const Socket = io(HOST+`/?token=${jwt}`);\n// const Updates = {}\n// const hola = () =>{ }\n// Socket.on('updates', (data) => {\n//     console.log(data);\n//     //Updates[data.canal](data.msg);\n// });\n\nvar check_version = function check_version() {\n  var fetchData = {\n    method: \"POST\",\n    body: JSON.stringify({}),\n    headers: {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\"\n    }\n  };\n  fetch(HOST + \"/version\", fetchData).then(function (res) {\n    return res.json();\n  }).then(function (res) {\n    if (window.localStorage.length) {\n      var version_anterior = +window.localStorage.getItem(\"version\");\n\n      if (!version_anterior || version_anterior < res.version) {\n        window.localStorage.setItem(\"version\", res.version);\n        window.location.reload(true);\n      }\n    }\n  });\n};\n\ncheck_version();\n\nvar CallProcess = function CallProcess(ruta, parametros, method) {\n  console.log(\"DATA\", ruta, parametros, method);\n  return new Promise(function (resolve, reject) {\n    var fetchData = {\n      method: method,\n      headers: {\n        Accept: \"application/json\",\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    console.log(\"MET\", method, parametros);\n    if (method == \"DELETE\") ruta = \"\".concat(ruta, \"/\").concat(parametros.id);else if (method != \"GET\" && method != \"HEAD\") {\n      var new_object = {};\n      var query = Object.keys(parametros).map(function (k) {\n        if (k[0] != \"_\") new_object[k] = parametros[k];\n      });\n      fetchData.body = JSON.stringify(new_object);\n    } else if (method == \"GET\") {\n      var esc = encodeURIComponent;\n      var query = Object.keys(parametros).map(function (k) {\n        return esc(k) + '=' + esc(parametros[k]);\n      }).join('&');\n      ruta = ruta + \"?\" + query;\n    }\n\n    if (jwt) {\n      fetchData.headers.Authorization = jwt || \"\";\n    }\n\n    fetch(HOST + \"/\" + ruta, fetchData).then(function (res) {\n      //    return res.json();\n      resolve(res.json());\n    }); //.then(callback);\n  });\n};\n\nvar _Resources =\n/*#__PURE__*/\nfunction () {\n  function Resources(resource) {\n    _classCallCheck(this, Resources);\n\n    this._proceso = resource;\n  }\n\n  _createClass(Resources, [{\n    key: \"new\",\n    value: function _new() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        resolve(_this);\n      });\n    }\n  }, {\n    key: \"set\",\n    value: function set(obj) {\n      var _arr = Object.keys(obj);\n\n      for (var _i = 0; _i < _arr.length; _i++) {\n        var o = _arr[_i];\n        this[o] = obj[o];\n      }\n    }\n  }, {\n    key: \"update\",\n    value: function update() {\n      var _this2 = this;\n\n      return new Promise(function (resolve, reject) {\n        CallProcess(_this2._proceso + \"/\" + _this2.id, _this2, 'PUT').then(function (res) {\n          var x = new Resources(_this2._proceso);\n          x.set(res);\n          resolve(x);\n        });\n      });\n    }\n  }, {\n    key: \"save\",\n    value: function save() {\n      var _this3 = this;\n\n      return new Promise(function (resolve, reject) {\n        CallProcess(_this3._proceso, _this3, \"POST\").then(function (res) {\n          var x = new Resources(_this3._proceso);\n          x.set(res);\n          resolve(x);\n        });\n      });\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete() {\n      var _this4 = this;\n\n      return new Promise(function (resolve, reject) {\n        for (var ix in _this4._padre._cadena) {\n          //console.log(ix, this._padre._cadena[ix].key, this.key);\n          if (_this4._padre._cadena[ix].key == _this4.key) {\n            _this4._padre._cadena.splice(ix, 1);\n\n            resolve(_this4._padre._cadena);\n            CallProcess(_this4._proceso, _this4, \"DELETE\");\n            return;\n          }\n        }\n      });\n    }\n  }, {\n    key: \"get\",\n    value: function get(id) {\n      var _this5 = this;\n\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      return new Promise(function (resolve, reject) {\n        CallProcess(_this5._proceso + \"/\" + id, params, \"GET\").then(function (res) {\n          var x = new Resources(_this5._proceso);\n          x.set(res);\n          resolve(x);\n        });\n      });\n    }\n  }, {\n    key: \"getMore\",\n    value: function getMore() {\n      return this.get(this.id);\n    }\n  }, {\n    key: \"getAll\",\n    value: function getAll() {\n      var _this6 = this;\n\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      return new Promise(function (resolve, reject) {\n        CallProcess(_this6._proceso, params, \"GET\").then(function (res) {\n          var resources = [];\n\n          for (var r in res) {\n            var x = new Resources(_this6._proceso);\n            x.set(res[r]);\n            x.key = r;\n            x._padre = _this6;\n            resources.push(x);\n          }\n\n          _this6._cadena = resources;\n          resolve(resources);\n        });\n      });\n    }\n  }, {\n    key: \"reload\",\n    value: function reload() {}\n  }]);\n\n  return Resources;\n}();\n\nif (!user) {}\n\nvar Botix =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Botix, _Component);\n\n  function Botix() {\n    var _getPrototypeOf2;\n\n    var _this7;\n\n    _classCallCheck(this, Botix);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this7 = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(Botix)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this7.usuario = user;\n    return _this7;\n  }\n\n  _createClass(Botix, [{\n    key: \"setLogin\",\n    value: function setLogin(res) {\n      user = res.user;\n      window.localStorage.setItem(\"user\", JSON.stringify(res.user));\n      window.localStorage.setItem(\"jwt\", res.jwt);\n      window.location = \"/\";\n    }\n  }, {\n    key: \"CloseSession\",\n    value: function CloseSession() {\n      window.localStorage.clear();\n      window.location = \"/\";\n    }\n  }, {\n    key: \"isLogin\",\n    value: function isLogin() {\n      if (!this.usuario) return false;\n      return true;\n    }\n  }, {\n    key: \"Resources\",\n    value: function Resources(process) {\n      return new _Resources(process);\n    }\n  }, {\n    key: \"CallProcess\",\n    value: function CallProcess(ruta, parametros, callback) {\n      var fetchData = {\n        method: \"POST\",\n        body: JSON.stringify(parametros),\n        headers: {\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\"\n        }\n      };\n\n      if (jwt) {\n        fetchData.headers.Authorization = jwt;\n      }\n\n      fetch(HOST + \"/\" + ruta, fetchData).then(function (res) {\n        return res.json();\n      }).then(callback);\n    }\n  }]);\n\n  return Botix;\n}(Component);\n\nexport default Botix;","map":{"version":3,"sources":["/Users/malba/Code/Botix/frontend/src/Botix.js"],"names":["React","Component","io","HOST","window","location","hostname","user","JSON","parse","localStorage","getItem","jwt","check_version","fetchData","method","body","stringify","headers","Accept","fetch","then","res","json","length","version_anterior","version","setItem","reload","CallProcess","ruta","parametros","console","log","Promise","resolve","reject","id","new_object","query","Object","keys","map","k","esc","encodeURIComponent","join","Authorization","Resources","resource","_proceso","obj","o","x","set","ix","_padre","_cadena","key","splice","params","get","resources","r","push","Botix","usuario","clear","process","callback"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport io from \"socket.io-client\";\nlet HOST\nif(window.window.location.hostname == \"localhost\")\nHOST = \"http://localhost:3040\";\nelse\nHOST = \"https://api.Botix.com\";\n\n\nHOST = \"http://192.168.7.103:3040\";\n\n\n\n\nlet user = JSON.parse(window.localStorage.getItem(\"user\"));\nlet jwt = window.localStorage.getItem(\"jwt\")\n\n// const Socket = io(\"https://api.labmovil.cl/?token=\" + window.token.vilab);\n//const Socket = io(HOST+`/?token=${jwt}`);\n// const Updates = {}\n\n// const hola = () =>{ }\n\n// Socket.on('updates', (data) => {\n//     console.log(data);\n//     //Updates[data.canal](data.msg);\n// });\nlet check_version = ()=>{\n   let fetchData = { method: \"POST\", body: JSON.stringify({}), headers: { Accept: \"application/json\", \"Content-Type\": \"application/json\" } };\n        fetch(HOST + \"/version\", fetchData)\n          .then(function(res) {\n            return res.json();\n          })\n          .then((res)=>{\n            if (window.localStorage.length){\n            let version_anterior = +(window.localStorage.getItem(\"version\"));\n            if (!version_anterior || version_anterior < res.version){\n              window.localStorage.setItem(\"version\", res.version);\n              window.location.reload(true);\n\n            }\n\n          }\n          });\n\n}\ncheck_version();\n\nconst CallProcess = (ruta, parametros, method) => {\n\n    console.log(\"DATA\",ruta, parametros, method )\n    return new Promise((resolve, reject) => {\n        let fetchData = {\n            method: method,\n            headers: {\n                Accept: \"application/json\",\n                \"Content-Type\": \"application/json\"\n            }\n        };\n\n        console.log(\"MET\",method,parametros)\n        if (method == \"DELETE\")\n            ruta = `${ruta}/${parametros.id}`\n\n        else if (method != \"GET\" && method != \"HEAD\"){\n\n\n            let new_object={}\n            var query = Object.keys(parametros)\n            .map(k => {\n                if (k[0]!= \"_\")\n                    new_object[k]=parametros[k] \n                 })  \n            fetchData.body = JSON.stringify(new_object);\n\n        }\n        else if (method == \"GET\"){\n            var esc = encodeURIComponent;\n            var query = Object.keys(parametros)\n            .map(k => esc(k) + '=' + esc(parametros[k]))\n            .join('&');\n            ruta = ruta+\"?\"+query\n\n        }\n            \n\n\n\n        if (jwt) {\n            fetchData.headers.Authorization = jwt || \"\";\n        }\n        fetch(HOST + \"/\" + ruta, fetchData).then(function (res) {\n            //    return res.json();\n            resolve(res.json());\n        });\n        //.then(callback);\n    });\n};\n\n\n\nclass Resources {\n    constructor(resource) {\n        this._proceso = resource;\n    }\n    new() {\n        return new Promise((resolve, reject) => {\n            resolve(this);\n        });\n    }\n    set(obj) {\n        for (let o of Object.keys(obj)) this[o] = obj[o];\n    }\n    update(){\n        return new Promise((resolve, reject) => {\n            CallProcess(this._proceso+\"/\"+this.id, this, 'PUT').then(res => {\n                  let x = new Resources(this._proceso);\n                x.set(res);\n                resolve(x);\n            })\n        })\n    }\n\n    save() {\n\n        return new Promise((resolve, reject) => {\n            CallProcess(this._proceso, this, \"POST\").then(res => {\n                let x = new Resources(this._proceso);\n                x.set(res);\n                resolve(x);\n            })\n        })\n\n    }\n    delete() {\n        return new Promise((resolve, reject) => {\n            for (let ix in this._padre._cadena) {\n                //console.log(ix, this._padre._cadena[ix].key, this.key);\n                if (this._padre._cadena[ix].key == this.key) {\n                    this._padre._cadena.splice(ix, 1);\n                    resolve(this._padre._cadena);\n                    CallProcess(this._proceso, this, \"DELETE\")\n                    return;\n                }\n            }\n        });\n    }\n    get(id, params = {}) {\n        return new Promise((resolve, reject) => {\n            CallProcess(this._proceso + \"/\" + id, params, \"GET\").then(res => {\n                let x = new Resources(this._proceso);\n                x.set(res);\n                resolve(x);\n            })\n        })\n    }\n    getMore() {\n\n        return this.get(this.id)\n\n\n    }\n    getAll(params = {}) {\n        return new Promise((resolve, reject) => {\n            CallProcess(this._proceso, params, \"GET\").then(res => {\n                let resources = [];\n                for (let r in res) {\n                    let x = new Resources(this._proceso);\n                    x.set(res[r]);\n                    x.key = r;\n                    x._padre = this;\n                    resources.push(x);\n                }\n                this._cadena = resources;\n                resolve(resources);\n            });\n        });\n    }\n    reload() { }\n}\n\nif (!user){\n\n    \n}\n\nclass Botix extends Component {\n  usuario = user;\n\n  setLogin(res){\n    user = res.user\n    window.localStorage.setItem(\"user\", JSON.stringify(res.user));\n    window.localStorage.setItem(\"jwt\", res.jwt);\n    window.location=\"/\"\n\n  }\n  CloseSession(){\n      window.localStorage.clear();\n      window.location = \"/\"\n  }\n\nisLogin(){\n    if (!this.usuario)\n    return false\n    return true\n}\n\n      Resources(process) {\n        return new Resources(process);\n    }\n\n  CallProcess(ruta, parametros, callback) {\n\n\n        let fetchData = { method: \"POST\", body: JSON.stringify(parametros), headers: { Accept: \"application/json\", \"Content-Type\": \"application/json\" } };\n        if (jwt) {\n          fetchData.headers.Authorization = jwt;\n        }\n        fetch(HOST + \"/\" + ruta, fetchData)\n          .then(function(res) {\n            return res.json();\n          })\n          .then(callback);\n\n\n  }\n\n}\n\nexport default Botix;"]},"metadata":{},"sourceType":"module"}